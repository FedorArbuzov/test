
<html>
    <head>
        <link rel="stylesheet" href="../w3.css">
    </head>
    <body>
        <div class="w3-col l10 m12" id="main">
<div id="mainLeaderboard" style="overflow:hidden;"><div id="yandex_rtb_R-A-1358578-1"></div><script>window.yaContextCb.push(()=>{Ya.Context.AdvManager.render({renderTo: 'yandex_rtb_R-A-1358578-1',blockId: 'R-A-1358578-1'})})</script></div><h1>SQL - UNION</h1>
<hr/>

<hr/>
<h2>UNION</h2>
<p>Оператор UNION используется для объединения результирующего набора из двух или более заявлений SELECT.</p>
<ul>
<li>Каждый оператор SELECT в UNION должен иметь одинаковое количество столбцов</li>
<li>Столбцы также должны иметь схожие типы данных</li>
<li>Столбцы в каждом заявлении SELECT также должны располагаться в том же порядке</li>
</ul>
<h3>Синтаксис UNION</h3>
<div class="w3-example">
<div class="w3-code notranslate sqlHigh">
SELECT <em>column_name(s)</em> FROM <em>table1</em><br/>
UNION<br/>
SELECT <em>column_name(s)</em> FROM <em>table2</em>;</div></div>
<h3>Синтаксис UNION ALL</h3>
<p>Оператор UNION по умолчанию выбирает только отдельные значения. Чтобы разрешить повторяющиеся значения, использовать UNION ALL:</p>
<div class="w3-example">
<div class="w3-code notranslate sqlHigh">
SELECT <em>column_name(s)</em> FROM <em>table1</em><br/>
UNION ALL<br/>
SELECT <em>column_name(s)</em> FROM <em>table2</em>;</div></div>
<p><b>Примечание:</b> Имена столбцов в результирующем наборе обычно равны именам столбцов в первом заявлении SELECT в UNION.</p>
<hr/>
<h2>Демо база данных</h2>
<p>В этом уроке мы будем использовать хорошо известный пример базы данных Northwind.</p>
<p>Ниже приведен выбор из таблицы "Customers":</p>
<div class="w3-responsive">
<table class="w3-table-all notranslate">
<tr>
<th style="width:15%">CustomerID</th>
<th>CustomerName</th>
<th>ContactName</th>
<th>Address</th>
<th>City</th>
<th>PostalCode</th>
<th>Country</th>
</tr>
<tr>
<td>1<br/><br/></td>
<td>Alfreds Futterkiste</td>
<td>Maria Anders</td>
<td>Obere Str. 57</td>
<td>Berlin</td>
<td>12209</td>
<td>Germany</td>
</tr>
<tr>
<td>2</td>
<td>Ana Trujillo Emparedados y helados</td>
<td>Ana Trujillo</td>
<td>Avda. de la Constitución 2222</td>
<td>México D.F.</td>
<td>05021</td>
<td>Mexico</td>
</tr>
<tr>
<td>3</td>
<td>Antonio Moreno Taquería</td>
<td>Antonio Moreno</td>
<td>Mataderos 2312</td>
<td>México D.F.</td>
<td>05023</td>
<td>Mexico</td>
</tr>
</table>
</div>
<p>И выбор из таблицы "Suppliers":</p>
<div class="w3-responsive">
<table class="w3-table-all notranslate">
<tr>
<th style="width:15%">SupplierID</th>
<th>SupplierName</th>
<th>ContactName</th>
<th>Address</th>
<th>City</th>
<th>PostalCode</th>
<th>Country</th>
</tr>
<tr>
<td>1</td>
<td>Exotic Liquid</td>
<td>Charlotte Cooper</td>
<td>49 Gilbert St.</td>
<td>London</td>
<td>EC1 4SD</td>
<td>UK</td>
</tr>
<tr>
<td>2</td>
<td>New Orleans Cajun Delights</td>
<td>Shelley Burke</td>
<td>P.O. Box 78934</td>
<td>New Orleans</td>
<td>70117</td>
<td>USA</td>
</tr>
<tr>
<td>3</td>
<td>Grandma Kelly's Homestead</td>
<td>Regina Murphy</td>
<td>707 Oxford Rd.</td>
<td>Ann Arbor</td>
<td>48104</td>
<td>USA</td>
</tr>
</table>
</div>
<hr/>
<div id="midcontentadcontainer" style="overflow:auto;text-align:center">
<!-- Yandex.RTB R-A-1358578-4 -->
<div id="yandex_rtb_R-A-1358578-4"></div>
<script>window.yaContextCb.push(()=>{
  Ya.Context.AdvManager.render({
    renderTo: 'yandex_rtb_R-A-1358578-4',
    blockId: 'R-A-1358578-4'
  })
})</script></div>
<hr/>
<h2>Пример SQL UNION</h2>
<p>Следующая инструкция SQL возвращает города (только отдельные значения) как из таблицы "Customers", так и из таблицы "Suppliers":</p>
<div class="w3-example">
<h3>Пример</h3>
<div class="w3-code notranslate sqlHigh">
SELECT City FROM Customers<br/>UNION<br/>SELECT City FROM Suppliers<br/>ORDER BY City;
</div>

</div>
<p><b>Примечание:</b> Если некоторые клиенты или поставщики имеют один и тот же город,
то каждый город будет указан только один раз, поскольку UNION выбирает только различные значения.
Используйте UNION ALL, чтобы также выбрать повторяющиеся значения!</p>
<hr/>
<h2>Пример SQL UNION ALL</h2>
<p>Следующая инструкция SQL возвращает города (также повторяющиеся значения) как из таблицы "Customers", так и из таблицы "Suppliers":</p>
<div class="w3-example">
<h3>Пример</h3>
<div class="w3-code notranslate sqlHigh">
SELECT City FROM Customers<br/>UNION ALL<br/>
SELECT City FROM Suppliers<br/>
ORDER BY City;
</div>

</div>
<hr/>
<h2>Пример SQL UNION с WHERE</h2>
<p>Следующая инструкция SQL возвращает немецкие города (только отдельные значения) как из таблицы "Customers", так и из таблицы "Suppliers":</p>
<div class="w3-example">
<h3>Пример</h3>
<div class="w3-code notranslate sqlHigh">
SELECT City, Country FROM Customers<br/>WHERE Country='Germany'<br/>UNION<br/>
SELECT City, Country FROM Suppliers<br/>WHERE Country='Germany'<br/>ORDER BY City;
</div>

</div>
<hr/>
<h2>Пример SQL UNION ALL с WHERE</h2>
<p>Следующая инструкция SQL возвращает немецкие города (также повторяющиеся значения) как из таблицы "Customers", так и из таблицы "Suppliers":</p>
<div class="w3-example">
<h3>Пример</h3>
<div class="w3-code notranslate sqlHigh">
SELECT City, Country FROM Customers<br/>WHERE Country='Germany'<br/>UNION ALL<br/>
SELECT City, Country FROM Suppliers<br/>WHERE Country='Germany'<br/>ORDER BY City;
</div>

</div>
<hr/>
<h2>Пример UNION другой</h2>
<p>Следующая инструкция SQL содержит список всех клиентов и поставщиков:</p>
<div class="w3-example">
<h3>Пример</h3>
<div class="w3-code notranslate sqlHigh">
SELECT 'Customer' As Type, ContactName, City, Country<br/>FROM Customers<br/>
UNION<br/>SELECT 'Supplier', ContactName, City, Country<br/>FROM Suppliers;
</div>

</div>
<p>Обратите внимание на "AS Type" выше - это псевдоним.
<a href="sql_alias.php">Псевдонимы SQL</a> используются для присвоения таблице или столбцу временного имени.
Псевдоним существует только на время выполнения запроса.
Итак, здесь мы создали временный столбец с именем "Type", который перечисляет, является ли контактное лицо "клиентом" или "поставщиком".</p>
<br/>

</div>
    </body>
</html>
